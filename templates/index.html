{% extends "base.html" %}

{% block content %}
<!-- Aurora Background -->
<div class="aurora-background">
    <div class="aurora aurora-1"></div>
    <div class="aurora aurora-2"></div>
    <div class="aurora aurora-3"></div>
</div>

<!-- Header Section with Rotating Globe -->
<div class="header-container mb-5">
    <div id="globe-container"></div>
    <div class="header-text text-center">
        <h1 class="display-4 fw-bold mb-3">
            <i class="fas fa-building-columns me-3 text-info"></i>
            AI Internship Matching System
        </h1>
        <p class="lead">
            Smart, transparent matching of students with their 
            <span class="text-info">future careers</span> using AI
        </p>
        {% if not session.user_type %}
        <div class="mt-4">
            <a href="#get-started" class="btn btn-primary btn-lg shadow-lg px-4 py-2" onclick="smoothScroll(event)">
                <i class="fas fa-sign-in-alt me-2"></i>Login / Get Started
            </a>
        </div>
        {% endif %}
    </div>
</div>

<div class="container-fluid py-5 position-relative" style="z-index:2;">
    <div class="row justify-content-center">
        <div class="col-lg-10">

            <!-- Features Section -->
            <div class="row g-4 mb-5">
                <div class="col-md-4">
                    <div class="card h-100 shadow-sm border-0 rounded-4">
                        <div class="card-body text-center">
                            <div class="feature-icon text-info mb-3 fs-1">
                                <i class="fas fa-robot"></i>
                            </div>
                            <h5 class="card-title">AI-Powered Matching</h5>
                            <p class="card-text">Algorithms analyze skills, preferences, and qualifications to find the best internship matches.</p>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="card h-100 shadow-sm border-0 rounded-4">
                        <div class="card-body text-center">
                            <div class="feature-icon text-success mb-3 fs-1">
                                <i class="fas fa-scale-balanced"></i>
                            </div>
                            <h5 class="card-title">Fair & Inclusive</h5>
                            <p class="card-text">Policies ensure fair opportunities across districts and social categories.</p>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="card h-100 shadow-sm border-0 rounded-4">
                        <div class="card-body text-center">
                            <div class="feature-icon text-warning mb-3 fs-1">
                                <i class="fas fa-chart-line"></i>
                            </div>
                            <h5 class="card-title">Smart Analytics</h5>
                            <p class="card-text">Detailed scoring system considering skills compatibility, location preferences, and academic achievements.</p>
                        </div>
                    </div>
                </div>
            </div>

            {% if not session.user_type %}
            <!-- Get Started Section -->
            <div id="get-started" class="row justify-content-center my-5">
                <div class="col-md-10">
                    <div class="card border-0 shadow-lg rounded-4">
                        <div class="card-body p-4">
                            <h2 class="card-title text-center mb-4 fw-bold">Get Started</h2>

                            <!-- Google OAuth Registration -->
                            <div class="mb-3">
                                <h5 class="text-center mb-4">
                                    <i class="fab fa-google me-2 text-danger"></i>Login or Register with Google
                                </h5>
                                <div class="row g-4 justify-content-center">
                                    <div class="col-md-6 col-lg-4">
                                        <div class="d-grid">
                                            <a href="{{ url_for('google_auth', type='student') }}" class="btn btn-danger btn-lg shadow-sm">
                                                <i class="fab fa-google me-2"></i>
                                                As Student
                                            </a>
                                        </div>
                                        <p class="text-center mt-3 small">
                                            <i class="fas fa-graduation-cap me-1"></i>
                                            Find your perfect internship opportunity
                                        </p>
                                    </div>
                                </div>
                            </div>

                            <!-- Email & Password Login -->
                            <div class="mt-4">
                                <hr class="my-4">
                                <h5 class="text-center mb-4">
                                    <i class="fas fa-envelope me-2 text-primary"></i>Login with Email & Password
                                </h5>
                                <form method="POST" action="{{ url_for('login') }}">
                                    <div class="row g-4">
                                        <div class="col-md-6">
                                            <div class="form-floating mb-3">
                                                <input type="email" class="form-control border-secondary" id="email" name="email" placeholder="Email" required>
                                                <label for="email">Email Address</label>
                                            </div>
                                            <div class="form-floating mb-3">
                                                <input type="password" class="form-control border-secondary" id="password" name="password" placeholder="Password" required>
                                                <label for="password">Password</label>
                                            </div>
                                            <div class="mb-3">
                                                <label for="user_type" class="form-label">I am a</label>
                                                <select class="form-select border-secondary text-dark bg-white" id="user_type" name="user_type" required>
                                                    <option value="">Choose...</option>
                                                    <option value="student">Student</option>
                                                    <option value="department">Government Department</option>
                                                    <option value="admin">System Administrator</option>
                                                </select>
                                            </div>
                                            <div class="d-grid">
                                                <button type="submit" class="btn btn-primary btn-lg shadow-sm">
                                                    <i class="fas fa-sign-in-alt me-2"></i>Login
                                                </button>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="card border-0 rounded-4 shadow-sm bg-light h-100">
                                                <div class="card-body text-center d-flex flex-column justify-content-center">
                                                    <h6 class="card-title text-success">
                                                        <i class="fas fa-user-plus me-2"></i>New User?
                                                    </h6>
                                                    <p class="card-text small">Don't have an account yet? Use the Google registration buttons above to create your account quickly and securely.</p>
                                                    <p class="small text-dark mt-3">
                                                        <i class="fas fa-shield-alt me-1"></i>
                                                        Already have an account? Enter your email and password on the left.
                                                    </p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </form>
                            </div>

                        </div>
                    </div>
                </div>
            </div>
            {% endif %}

            <!-- How It Works Section -->
            <div class="mt-5 pt-5 text-center">
                <h2 class="fw-bold mb-5">How It Works</h2>
                <div class="row g-5">
                    <div class="col-md-3">
                        <div class="step-card">
                            <div class="step-number mx-auto mb-3">1</div>
                            <h6 class="fw-bold">Register & Profile</h6>
                            <p class="small text-muted">Create a detailed profile with your skills, academics, and preferences.</p>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="step-card">
                            <div class="step-number mx-auto mb-3">2</div>
                            <h6 class="fw-bold">AI Analysis</h6>
                            <p class="small text-muted">Our AI analyzes your profile against available internships for the best fit.</p>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="step-card">
                             <div class="step-number mx-auto mb-3">3</div>
                            <h6 class="fw-bold">Smart Matching</h6>
                            <p class="small text-muted">Receive a ranked list of personalized internship matches.</p>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="step-card">
                             <div class="step-number mx-auto mb-3">4</div>
                            <h6 class="fw-bold">Connect & Apply</h6>
                            <p class="small text-muted">Connect with departments and apply for your preferred opportunities.</p>
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </div>
</div>

<!-- Styles -->
<style>
    body {
        background: linear-gradient(135deg, #dbeafe 0%, #f8fafc 100%);
        color: #1f2937;
    }
    h1, h2, h5, .fw-bold {
        color: #1e3a8a !important;
    }
    p, label, .lead, .card-text {
        color: #111827 !important;
    }
    
    .form-control::placeholder {
        color: #6b7280;
    }
     .form-floating > label {
        background-color: #dbeafe !important;  /* extra light blue */
        color: #000000 !important;             /* black text */
        padding: 0 0.25rem !important;         /* smaller horizontal padding */
        height: auto !important;               /* auto height */
        line-height: normal !important;        /* prevent tall box */
        border-radius: 0.2rem;
        font-size: 0.8rem;  
    }

    .form-control {
        background-color: #ffffff !important;
        color: #111827 !important;
    }
    .form-control:focus {
        background-color: #ffffff !important;
        color: #111827 !important;
        border-color: #2563eb !important;
        box-shadow: 0 0 0 0.2rem rgba(37, 99, 235, 0.25);
    }
    .form-floating > label::after {
    background-color: transparent !important;
    }
    .form-select {
        color: #111827 !important;
        background-color: #ffffff !important;
    }
    .form-select option {
        color: #111827 !important;
        background-color: #ffffff !important;
    }

    .btn-primary {
        background: #1e3a8a;
        border: none;
        color: #fff;
    }
    .btn-primary:hover {
        background: #172554;
    }
    .text-info {
        color: #2563eb !important;
    }

    .aurora-background {
        position: fixed;
        top: 0; left: 0;
        width: 100%; height: 100%;
        z-index: -1;
        background: transparent;
        overflow: hidden;
    }
    .aurora {
        position: absolute;
        border-radius: 50%;
        filter: blur(80px);
        opacity: 0.25;
    }
    .aurora-1 {
        width: 50vw; height: 50vw;
        background-color: #93c5fd;
        top: -25vw; left: -25vw;
        animation: move 15s infinite alternate ease-in-out;
    }
    .aurora-2 {
        width: 60vw; height: 60vw;
        background-color: #bfdbfe;
        bottom: -30vw; right: -30vw;
        animation: move 20s infinite alternate-reverse ease-in-out;
    }
    .aurora-3 {
        width: 40vw; height: 40vw;
        background-color: #dbeafe;
        bottom: 20vh; left: -20vw;
        animation: move 18s infinite alternate ease-in-out;
    }
    @keyframes move {
        from { transform: translate(0, 0) rotate(0deg); }
        to { transform: translate(100px, 50px) rotate(30deg); }
    }

    .header-container {
        position: relative;
        height: 60vh;
        display: flex;
        align-items: center;
        justify-content: center;
        text-align: center;
    }
    #globe-container {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        z-index: 1;
        cursor: grab;
    }
    .header-text {
        position: relative;
        z-index: 2;
        text-shadow: 0 0 15px rgba(255,255,255,0.8);
    }
    
    /* How It Works Section Styles */
    .step-number {
        width: 50px;
        height: 50px;
        border-radius: 50%;
        background-color: #dbeafe; /* Light blue */
        color: #1e3a8a; /* Dark blue */
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.5rem;
        font-weight: bold;
        border: 2px solid #bfdbfe;
    }
    .step-card h6 {
        color: #1e3a8a !important;
    }
    .step-card .text-muted {
        color: #4b5563 !important;
    }
    .card {
        background-color: #ffffff !important;  /* White background */
        border: none;
        border-radius: 12px;
        box-shadow: 0 4px 6px rgba(0,0,0,0.1);
    }
    .navbar {
    background-color: #75c6fc !important;   /* light blue */
    border-bottom: none !important;         /* remove faint white line */
    }
</style>

<!-- Three.js for 3D Globe -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>

<script>
document.addEventListener('DOMContentLoaded', function () {
    const globeContainer = document.getElementById('globe-container');
    if (globeContainer) {
        const scene = new THREE.Scene();
        const camera = new THREE.PerspectiveCamera(75, globeContainer.offsetWidth / globeContainer.offsetHeight, 0.1, 1000);
        const renderer = new THREE.WebGLRenderer({ alpha: true });
        renderer.setSize(globeContainer.offsetWidth, globeContainer.offsetHeight);
        renderer.setPixelRatio(window.devicePixelRatio);
        globeContainer.appendChild(renderer.domElement);

        const geometry = new THREE.SphereGeometry(2.5, 32, 32);
        
        const pointsMaterial = new THREE.PointsMaterial({
            color: 0x0f172a,
            size: 0.04,
            transparent: true,
            opacity: 0.8,
            blending: THREE.AdditiveBlending,
            depthWrite: false,
        });
        const points = new THREE.Points(geometry, pointsMaterial);
        scene.add(points);
        
        camera.position.z = 5;

        let mouseX = 0, mouseY = 0;
        document.addEventListener('mousemove', (event) => {
            mouseX = (event.clientX / window.innerWidth) * 2 - 1;
            mouseY = -(event.clientY / window.innerHeight) * 2 + 1;
        });

        function animate() {
            requestAnimationFrame(animate);
            points.rotation.y += 0.001;
            points.rotation.y += mouseX * 0.0005;
            points.rotation.x += mouseY * 0.0005;
            renderer.render(scene, camera);
        }
        animate();

        window.addEventListener('resize', () => {
              renderer.setSize(globeContainer.offsetWidth, globeContainer.offsetHeight);
              camera.aspect = globeContainer.offsetWidth / globeContainer.offsetHeight;
              camera.updateProjectionMatrix();
        });
    }
});

function smoothScroll(event) {
    event.preventDefault();
    const target = document.querySelector('#get-started');
    if (target) {
        target.scrollIntoView({
            behavior: 'smooth',
            block: 'start'
        });
    }
}
</script>
{% endblock %}
